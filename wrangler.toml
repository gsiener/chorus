name = "chorus"
main = "src/index.ts"
compatibility_date = "2025-11-17"
compatibility_flags = ["nodejs_compat", "nodejs_als"]

# KV namespace for knowledge base documents
[[kv_namespaces]]
binding = "DOCS_KV"
id = "bf1f6f46baef45abb76000eaa432814f"

# Vectorize for semantic document search
[[vectorize]]
binding = "VECTORIZE"
index_name = "chorus-docs"

# Workers AI for generating embeddings
[ai]
binding = "AI"

# Secrets (set via `wrangler secret put`):
# - SLACK_BOT_TOKEN
# - SLACK_SIGNING_SECRET
# - ANTHROPIC_API_KEY
# - HONEYCOMB_API_KEY

# Cron trigger for DM check-ins (daily 9am ET / 14:00 UTC)
[triggers]
crons = ["0 14 * * *"]

# Native OpenTelemetry export to Honeycomb
# Destinations configured in Cloudflare Dashboard:
#   Workers & Pages → chorus → Settings → Observability → Destinations
[observability.traces]
enabled = true
destinations = ["honeycomb-traces"]

[observability.logs]
enabled = true
destinations = ["honeycomb-logs"]
